{% load static %}

<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö–∞–ª–µ–Ω–¥–∞—Ä</title>

  <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ CSS -->
  <link rel="stylesheet" href="{% static 'calendarapp/calendar.css' %}">

  <!-- Flatpickr -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>
<body>

  <div class="calendar-icon" onclick="toggleCalendar()">üóìÔ∏è</div>

  <div class="calendar-popup" id="calendarPopup">
    <h3>–ö–∞–ª–µ–Ω–¥–∞—Ä –ø–æ–¥—ñ–π</h3>
    <input type="text" id="calendarInput" placeholder="–û–±–µ—Ä—ñ—Ç—å –¥–∞—Ç—É">
    <button onclick="saveDate()">–ó–±–µ—Ä–µ–≥—Ç–∏ –¥–∞—Ç—É</button>
  </div>

  <div id="savedDates">
    <h4>–û–±—Ä–∞–Ω—ñ –¥–∞—Ç–∏:</h4>
    <ul id="dateList"></ul>
  </div>

  <!-- Flatpickr JS -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

  <!-- JS –ø—Ä—è–º–æ –∑–¥–µ—Å—å, –Ω–æ –º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ -->
  <script>
    function toggleCalendar() {
      const popup = document.getElementById("calendarPopup");
      popup.classList.toggle("active");
    }

    window.addEventListener("click", function(e) {
      const popup = document.getElementById("calendarPopup");
      const icon = document.querySelector(".calendar-icon");
      if (!popup.contains(e.target) && !icon.contains(e.target)) {
        popup.classList.remove("active");
      }
    });

    const fp = flatpickr("#calendarInput", {
      enableTime: true,
      dateFormat: "Y-m-d H:i",
      time_24hr: true,
      locale: "ru"
    });

    function saveDate() {
      const selectedDate = document.getElementById("calendarInput").value;
      if (selectedDate) {
        const list = document.getElementById("dateList");
        const li = document.createElement("li");
        li.textContent = selectedDate;
        list.appendChild(li);
        document.getElementById("calendarInput").value = '';
      } else {
        alert("–ë—É–¥—å –ª–∞—Å–∫–∞, –æ–±–µ—Ä—ñ—Ç—å –¥–∞—Ç—É –ø–µ—Ä–µ–¥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º!");
      }
    }
  </script>

</body>
</html>
